CREATE TABLE SAL02_ITEM_PRICES (
  COMPANY_CODE_SYS01 VARCHAR(20) NOT NULL,
  ITEM_CODE_ITM01 VARCHAR(20) NOT NULL,
  PRICELIST_CODE_SAL01 VARCHAR(20) NOT NULL,
  START_DATE DATETIME NOT NULL,
  VALUE DECIMAL(18,5) NOT NULL,
  END_DATE DATETIME,
  CREATE_USER VARCHAR(20),
  CREATE_DATE DATETIME,
  LAST_UPDATE_USER VARCHAR(20),
  LAST_UPDATE_DATE DATETIME,   
  PRIMARY KEY(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, PRICELIST_CODE_SAL01, START_DATE)
);


INSERT INTO SAL02_ITEM_PRICES(COMPANY_CODE_SYS01,ITEM_CODE_ITM01,PRICELIST_CODE_SAL01,START_DATE,VALUE,END_DATE,CREATE_USER,CREATE_DATE,LAST_UPDATE_USER,LAST_UPDATE_DATE)
SELECT COMPANY_CODE_SYS01,ITEM_CODE_ITM01,PRICELIST_CODE_SAL01,START_DATE,VALUE,END_DATE,CREATE_USER,CREATE_DATE,LAST_UPDATE_USER,LAST_UPDATE_DATE FROM SAL02_PRICES;

COMMIT;

DROP TABLE SAL02_PRICES;


CREATE TABLE PUR05_SUP_ITEM_VARIANTS_PRICES (
  COMPANY_CODE_SYS01 VARCHAR(20) NOT NULL,
  PROGRESSIVE NUMERIC(12) NOT NULL,
  PROGRESSIVE_REG04 NUMERIC(12) NOT NULL,
  ITEM_CODE_ITM01 VARCHAR(20) NOT NULL,
  PRICELIST_CODE_PUR03 VARCHAR(20) NOT NULL,
  VARIANT_TYPE_ITM06 VARCHAR(20) NOT NULL,
  VARIANT_CODE_ITM11 VARCHAR(20) NOT NULL,
  VARIANT_TYPE_ITM07 VARCHAR(20) NOT NULL,
  VARIANT_CODE_ITM12 VARCHAR(20) NOT NULL,
  VARIANT_TYPE_ITM08 VARCHAR(20) NOT NULL,
  VARIANT_CODE_ITM13 VARCHAR(20) NOT NULL,
  VARIANT_TYPE_ITM09 VARCHAR(20) NOT NULL,
  VARIANT_CODE_ITM14 VARCHAR(20) NOT NULL,
  VARIANT_TYPE_ITM10 VARCHAR(20) NOT NULL,
  VARIANT_CODE_ITM15 VARCHAR(20) NOT NULL,
  VALUE DECIMAL(18,5) NOT NULL,
  START_DATE DATETIME NULL,
  END_DATE DATETIME NULL,
  CREATE_USER VARCHAR(20),
  CREATE_DATE DATETIME,
  LAST_UPDATE_USER VARCHAR(20),
  LAST_UPDATE_DATE DATETIME,   
  PRIMARY KEY(COMPANY_CODE_SYS01,PROGRESSIVE),
  INDEX PUR05_FKIndex1(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM06, VARIANT_CODE_ITM11),
  INDEX PUR05_FKIndex2(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM07, VARIANT_CODE_ITM12),
  INDEX PUR05_FKIndex3(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM08, VARIANT_CODE_ITM13),
  INDEX PUR05_FKIndex4(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM09, VARIANT_CODE_ITM14),
  INDEX PUR05_FKIndex5(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM10, VARIANT_CODE_ITM15),
  INDEX PUR05_FKIndex6(COMPANY_CODE_SYS01, PROGRESSIVE_REG04, ITEM_CODE_ITM01, PRICELIST_CODE_PUR03),
  FOREIGN KEY(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM06, VARIANT_CODE_ITM11)
    REFERENCES ITM16_PRODUCT_VARIANTS_1(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM06, VARIANT_CODE_ITM11)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM07, VARIANT_CODE_ITM12)
    REFERENCES ITM17_PRODUCT_VARIANTS_2(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM07, VARIANT_CODE_ITM12)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM08, VARIANT_CODE_ITM13)
    REFERENCES ITM18_PRODUCT_VARIANTS_3(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM08, VARIANT_CODE_ITM13)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM09, VARIANT_CODE_ITM14)
    REFERENCES ITM19_PRODUCT_VARIANTS_4(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM09, VARIANT_CODE_ITM14)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM10, VARIANT_CODE_ITM15)
    REFERENCES ITM20_PRODUCT_VARIANTS_5(COMPANY_CODE_SYS01, ITEM_CODE_ITM01, VARIANT_TYPE_ITM10, VARIANT_CODE_ITM15)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
);

INSERT INTO PUR05_SUP_ITEM_VARIANTS_PRICES(
  COMPANY_CODE_SYS01,PROGRESSIVE,PROGRESSIVE_REG04,ITEM_CODE_ITM01,PRICELIST_CODE_PUR03,VARIANT_TYPE_ITM06,VARIANT_CODE_ITM11,
  VARIANT_TYPE_ITM07,VARIANT_CODE_ITM12,VARIANT_TYPE_ITM08,VARIANT_CODE_ITM13,VARIANT_TYPE_ITM09,VARIANT_CODE_ITM14,VARIANT_TYPE_ITM10,
  VARIANT_CODE_ITM15,VALUE,START_DATE,END_DATE
)
SELECT COMPANY_CODE_SYS01,PROGRESSIVE,PROGRESSIVE_REG04,ITEM_CODE_ITM01,PRICELIST_CODE_PUR03,VARIANT_TYPE_ITM06,VARIANT_CODE_ITM11,
  VARIANT_TYPE_ITM07,VARIANT_CODE_ITM12,VARIANT_TYPE_ITM08,VARIANT_CODE_ITM13,VARIANT_TYPE_ITM09,VARIANT_CODE_ITM14,VARIANT_TYPE_ITM10,
  VARIANT_CODE_ITM15,VALUE,START_DATE,END_DATE
FROM PUR05_SUPPLIER_VARIANTS_PRICES;

COMMIT;

DROP TABLE PUR05_SUPPLIER_VARIANTS_PRICES;


CREATE TABLE PUR04_SUPPLIER_ITEM_PRICES (
  COMPANY_CODE_SYS01 VARCHAR(20) NOT NULL,
  PROGRESSIVE_REG04 NUMERIC(12) NOT NULL,
  ITEM_CODE_ITM01 VARCHAR(20) NOT NULL,
  PRICELIST_CODE_PUR03 VARCHAR(20) NOT NULL,
  START_DATE DATETIME NOT NULL,
  VALUE DECIMAL(18,5) NOT NULL,
  END_DATE DATETIME,
  CREATE_USER VARCHAR(20),
  CREATE_DATE DATETIME,
  LAST_UPDATE_USER VARCHAR(20),
  LAST_UPDATE_DATE DATETIME,   
  PRIMARY KEY(COMPANY_CODE_SYS01, PROGRESSIVE_REG04, ITEM_CODE_ITM01, PRICELIST_CODE_PUR03, START_DATE),
  INDEX PUR04_FKIndex1(COMPANY_CODE_SYS01, PROGRESSIVE_REG04, PRICELIST_CODE_PUR03),
  INDEX PUR04_FKIndex2(COMPANY_CODE_SYS01, PROGRESSIVE_REG04, ITEM_CODE_ITM01),
  FOREIGN KEY(COMPANY_CODE_SYS01, PROGRESSIVE_REG04, PRICELIST_CODE_PUR03)
    REFERENCES PUR03_SUPPLIER_PRICELISTS(COMPANY_CODE_SYS01, PROGRESSIVE_REG04, PRICELIST_CODE)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION,
  FOREIGN KEY(COMPANY_CODE_SYS01, PROGRESSIVE_REG04, ITEM_CODE_ITM01)
    REFERENCES PUR02_SUPPLIER_ITEMS(COMPANY_CODE_SYS01, PROGRESSIVE_REG04, ITEM_CODE_ITM01)
      ON DELETE NO ACTION
      ON UPDATE NO ACTION
);

INSERT INTO PUR04_SUPPLIER_ITEM_PRICES(COMPANY_CODE_SYS01,PROGRESSIVE_REG04,ITEM_CODE_ITM01,PRICELIST_CODE_PUR03,START_DATE,VALUE,END_DATE,CREATE_USER,CREATE_DATE,LAST_UPDATE_USER,LAST_UPDATE_DATE)
SELECT COMPANY_CODE_SYS01,PROGRESSIVE_REG04,ITEM_CODE_ITM01,PRICELIST_CODE_PUR03,START_DATE,VALUE,END_DATE,CREATE_USER,CREATE_DATE,LAST_UPDATE_USER,LAST_UPDATE_DATE FROM PUR04_SUPPLIER_PRICES;

COMMIT;

DROP TABLE PUR04_SUPPLIER_PRICES;




